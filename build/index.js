(()=>{var e={669:(e,t,s)=>{s(818).config(),e.exports={mongoDbUrl:process.env.MONGO_DB_URL,logDbUrl:process.env.LOG_DB_URL,tokenSecretKey:process.env.JWT_SECRET,port:process.env.PORT,adminSecretKey:process.env.ADMIN_SECRET_KEY}},865:(e,t,s)=>{const a=s(37),{mongoDbUrl:n}=s(669);e.exports={connectToDB:function(){try{a.connect(n)}catch(e){return console.log("Unable to connect to database"),e}}}},593:(e,t,s)=>{const a=s(107),n=s(829),r=s(486),{getCurrentIPAddress:u,generateRandomAlphaNumericID:i}=(s(903),s(928),s(93)),{port:d,tokenSecretKey:m}=s(669);e.exports={createAdmin:async(e,t)=>{try{let{name:s,email:n,password:u,mobile:d}=e.body;if(!(s&&n&&u&&d))return t.status(400).send({status:!1,message:"All fields are required"});u=await r.hash(u,10);let m={userId:i(26),name:s,email:n,password:u,mobile:d},o=await a.create(m);return t.status(201).send({status:!0,message:"Admin created",data:o})}catch(e){return t.status(500).send({status:!1,message:e.message})}},adminLogin:async(e,t)=>{try{let{email:s,password:u}=e.body;if(!s||!u)return t.status(400).send({status:!1,message:"Email and password are required"});let d=await a.findOne({email:s});if(!d)return t.status(400).send({status:!1,message:"Bad Reques!!!"});r.compare(u,d.password,(function(e,a){if(e)throw e;!async function(e){if(e){let e={},a=Date.now(),r=Math.floor(a/1e3),u=n.sign({email:d.email,adminId:d._id.toString(),iat:r},m,{expiresIn:"24h"});return e._id=d._id.toString(),e.email=s,e.token=u,t.setHeader("Authorization","Bearer",u),d.sessionToken=i(51),await d.save(),t.status(200).send({status:!0,message:"Successfully login",data:e})}t.status(401).send({status:!1,message:"Login denied"})}(a)}))}catch(e){return t.status(500).send({status:!1,message:e.message})}},getAllBookingsOfUser:async(e,t)=>{try{const{adminId:s,sessionToken:n,userId:r}=e.params;if(!s||!n)return t.status(400).send({status:!1,message:"All fields are required"});let u=await a.findOne({adminId:s,sessionToken:n});if(!u)return t.status(404).send({status:!1,message:"Bad Reques!!!"});if(u.adminId===s&&u.sessionToken===n){if(!await userModel.findOne({userId:r}))return t.status(404).send({status:!1,message:"User Not Found"});let e=await bookingModel.find({userId:r});return t.status(200).send({status:!0,message:"Success",data:e})}return t.status(400).send({status:!1,message:"Session Expired"})}catch(e){return t.status(500).send({status:!1,message:e.message})}},getOneDayBookings:async(e,t)=>{try{const{adminId:s,sessionToken:n}=e.params;if(!s||!n)return t.status(400).send({status:!1,message:"All fields are required"});let r=await a.findOne({adminId:s,sessionToken:n});if(!r)return t.status(404).send({status:!1,message:"Bad Reques!!!"});if(r.adminId===s&&r.sessionToken===n){let s;if(e.params.date)s=e.params.date;else{let e=new Date;const t=e.getFullYear();s=`${t}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}let a=await bookingModel.find({BookingDate:s}),n=0;for(let e of a)n+=e.grand_total;let r={totalBookings:a,oneDayRevenue:n};return t.status(200).send({status:!0,message:"Success",data:r})}return t.status(400).send({status:!1,message:"Session Expired"})}catch(e){return t.status(500).send({status:!1,message:e.message})}},getOneWeekBookings:async(e,t)=>{try{let{adminId:s,sessionToken:n}=e.params;if(!s||!n)return t.status(400).send({status:!1,message:"All fields are required"});let r=await a.findOne({adminId:s,sessionToken:n});if(!r)return t.status(404).send({status:!1,message:"Bad Reques!!!"});if(r.adminId===s&&r.sessionToken===n){let s,a;if(e.params.startDate&&e.params.endDate)s=e.params.startDate,a=e.params.endDate;else{const e=new Date,t=e.getFullYear();a=`${t}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`;const n=new Date(e.getTime()-6048e5),r=n.getFullYear();s=`${r}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`}let n=await bookingModel.find({BookingDate:{$gte:s,$lte:a}}),r=0;if(n.length)for(let e of n)r+=e.grand_total;let u={oneWeekBookings:n,grandTotal:r};return t.status(200).send({status:!0,message:"Success",data:u})}return t.status(403).send({status:!1,message:"Session Expired"})}catch(e){return t.status(500).send({status:!1,message:e.message})}},getOneMonthBookings:async(e,t)=>{try{const{adminId:s,sessionToken:n,month:r,year:u}=e.params;if(!(s&&n&&r&&u))return t.status(400).send({status:!1,message:"All fields are required"});let i=await a.findOne({adminId:s,sessionToken:n});if(!i)return t.status(404).send({status:!1,message:"Bad Reques!!!"});if(i.adminId===s&&i.sessionToken===n){const e=`${u}-${r}-01`,s=`${u}-${r}-31`,a=await bookingModel.find({createdAt:{$gte:e,$lte:s}});let n=0;if(a.length)for(let e of a)n+=e.grand_total;let i={oneMonthBookings:a,oneMonthRevenue:n};return t.status(200).send({status:!0,message:"Success",data:i})}return t.status(400).send({status:!1,message:"Session Expired"})}catch(e){return t.status(500).send({status:!1,message:e.message})}},getOneYearBookings:async(e,t)=>{try{const{adminId:s,sessionToken:n,year:r}=e.params;if(!s||!n||!r)return t.status(400).send({status:!1,message:"All fields are required"});let u=await a.findOne({adminId:s,sessionToken:n});if(!u)return t.status(404).send({status:!1,message:"Bad Reques!!!"});if(u.adminId===s&&u.sessionToken===n){const e=`${r}-01-01`,s=`${r}-12-31`;let a=await bookingModel.find({createdAt:{$gte:e,$lte:s}}),n=0;if(a.length)for(let e of a)n+=e.grand_total;let u={oneYearRequests:a,oneYearRevenue:n};return t.status(200).send({status:!0,message:"Success",data:u})}return t.status(400).send({status:!1,message:"Session Expired"})}catch(e){return t.status(500).send({status:!1,message:e.message})}}}},506:(e,t,s)=>{const a=s(915),{getCurrentIPAddress:n}=s(93),r=s(903),u=s(928),i=s(896),{port:d,adminSecretKey:m}=s(669),{isValidObjectId:o}=s(37);e.exports={getDashboard:async(e,t)=>{try{let{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"UserId is required"});let n=await a.findOne({userId:s});if(!n)return t.status(400).send({status:!1,message:"Restaurant not found"});let r=n.banners;return t.status(200).send({status:!0,message:"Success",banners:r})}catch(e){return t.status(400).send({status:!1,message:e.message})}},updateBannerImages:async(e,t)=>{try{let{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Bad Request!!!"});let m=await a.findOne({userId:s});if(!m)return t.status(400).send({status:!1,message:"Restaurant Not found"});let{ImageModel:o}=e.body,l=JSON.parse(o),g=e.files.bannerImage;if(!g)return t.status(400).send({status:!1,message:"No banner image uploaded"});let c=l.index,p=(l.img_id&&l.img_id,l.imageName,l.isNewPick),f=n(),y="/banners/",I=r.v4()+"."+g.name.split(".").pop(),_=`http://${f}:${d}${y}`,b=u.join(__dirname,"..","banners",I);if(p){g.mv(b,(e=>{if(e)throw e}));let e={imageName:I,imagePath:_};return m.banners.push(e),await m.save(),t.status(200).send({status:!0,message:"Banner added successfully",banners:m.banners})}{let e=m.banners[c].imageName,s=u.join(__dirname,"..","banners",e);i.existsSync(s)&&i.unlinkSync(s),g.mv(b,(e=>{if(e)throw e}));let a={imageName:I,imagePath:_};return m.banners[c]=a,await m.save(),t.status(200).send({status:!0,message:"Banner updated successfully",banners:m.banners})}}catch(e){return t.status(400).send({status:!1,message:e.message})}},deleteBannerImage:async(e,t)=>{try{let{userId:s,imageId:n}=e.params;if(!s||!n)return t.status(400).send({status:!1,message:"All fields are required"});let r=await a.findOne({userId:s});if(!r)return t.status(400).send({status:!1,message:"Not Found!!!"});if(r.banners.length)for(let e=0;e<r.banners.length;e++)if(n===r.banners[e]._id.toString()){let t=r.banners[e].imageName,s=u.join(__dirname,"..","banners",t);i.existsSync(s)&&i.unlinkSync(s);let a=r.banners;a.splice(e,1),r.banners=a,await r.save()}return t.status(200).send({status:!0,message:"Banner deleted successfully",banners:r.banners})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getAllBannerImages:async(e,t)=>{try{let{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"userId is required"});let n=await a.findOne({userId:s});if(!n)return t.status(400).send({status:!1,message:"Restaurant not found"});let r=n.banners;return t.status(200).send({status:!0,message:"Success",banners:r})}catch(e){return t.status(400).send({status:!1,message:e.message})}}}},295:(e,t,s)=>{const a=s(3),n=s(915),r=s(903),u=s(928),i=s(896),{getCurrentIPAddress:d,generateRandomAlphaNumericID:m}=s(93),{port:o}=s(669),{isValidObjectId:l}=s(37),{adminSecretKey:g}=s(669);e.exports={addItems:async(e,t)=>{try{let{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"User Id is required"});if(!await n.findOne({userId:s}))return t.status(400).send({status:!1,message:"Restaurant Not Found"});let{menuId:r,item_name:u,menuName:i,description:d,selling_price:m,isTaxable:o,preparing_time:l,notes:g,visit_count:c,status:p,seo_keywords:f,video_link:y,isVeg:I}=e.body,_={userId:s,menuId:r,item_name:u,menuName:i,description:d,selling_price:m,isTaxable:o,preparing_time:l,notes:g,visit_count:c,status:p,seo_keywords:f,video_link:y||"",isVeg:I},b=await a.create(_);return t.status(200).send({status:!0,message:"Item Added Successfully",data:b})}catch(e){return t.status(400).send({status:!1,message:e.message})}},addUpdateItemImages:async(e,t)=>{try{let{itemId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Item Id is required"});if(!l(s))return t.status(400).send({status:!1,message:"Invalid itemId"});let n=await a.findById(s);if(!n)return t.status(400).send({status:!1,message:"Item Not Found"});let{ImageModel:m}=e.body,g=JSON.parse(m),c=e.files.itemImage;if(!c)return t.status(400).send({status:!1,message:"No item image uploaded"});let{index:p,img_id:f,imageName:y,isNewPick:I}=g,_=d(),b="/items/",h=r.v4()+"."+c.name.split(".").pop(),S=`http://${_}:${o}${b}`,w=u.join(__dirname,"..","items",h);if(I){c.mv(w,(e=>{if(e)throw e}));let e={imgName:h,imgPath:S};return n.item_images.push(e),await n.save(),t.status(200).send({status:!0,message:"Item image added successfully",data:n.item_images})}{let e=n.item_images[p].imgName,s=u.join(__dirname,"..","items",e);i.existsSync(s)&&i.unlinkSync(s),c.mv(w,(e=>{if(e)throw e}));let a={imgName:h,imgPath:S};return n.item_images[p]=a,await n.save(),t.status(200).send({status:!0,message:"Item image updated successfully",data:n.item_images})}}catch(e){return t.status(400).send({status:!1,message:e.message})}},deleteItemImages:async(e,t)=>{try{let{itemId:s,imageId:n}=e.params;if(!n)return t.status(400).send({status:!1,message:"all fields are required"});let r=await a.findById(s);if(!r)return t.status(400).send({status:!1,message:"Item not found"});if(r.item_images.length)for(let e=0;e<r.item_images.length;e++)if(n===r.item_images[e]._id.toString()){let t=r.item_images;t.splice(e,1),r.item_images=t,await r.save()}return t.status(200).send({status:!0,message:"Image deleted successfully",data:r.item_images})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getAllItems:async(e,t)=>{try{let{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"UserId is required"});let n=await a.find({userId:s});return t.status(200).send({status:!0,message:"Success",data:n})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getItemById:async(e,t)=>{try{const{itemId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Item Id is required"});if(!l(s))return t.status(400).send({status:!1,message:"Invalid Item Id"});let n=await a.findById(s);return n?t.status(200).send({status:!0,message:"Success",data:n}):t.status(400).send({status:!1,message:"Item Not Found"})}catch(e){return t.status(400).send({status:!1,message:e.message})}},updateItemById:async(e,t)=>{try{let{itemId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Item Id is required"});if(!l(s))return t.status(400).send({status:!1,message:"Invalid Item Id"});let n=await a.findById(s);if(!n)return t.status(400).send({status:!1,message:"Item Not Found"});let r=e.body;return"item_name"in r&&(n.item_name=r.item_name),"description"in r&&(n.description=r.description),"selling_price"in r&&(n.selling_price=r.selling_price),"isTaxable"in r&&(n.isTaxable=r.isTaxable),"preparing_time"in r&&(n.preparing_time=r.preparing_time),"notes"in r&&(n.notes=r.notes),"visit_count"in r&&(n.visit_count=r.visit_count),"status"in r&&(n.status=r.status),"seo_keywords"in r&&(n.seo_keywords=r.seo_keywords),"video_link"in r&&(n.video_link=r.video_link),"isVeg"in r&&(n.isVeg=r.isVeg),await n.save(),t.status(200).send({status:!0,message:"Item Updated Successfully",data:n})}catch(e){return t.status(400).send({status:!1,message:e.message})}},deleteItemById:async(e,t)=>{try{const{itemId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Item Id is required"});if(!l(s))return t.status(400).send({status:!1,message:"Invalid Item Id"});let n=await a.findById(s);if(!n)return t.status(400).send({status:!1,message:"Item Not Found"});let r=n.item_images.imgName;if(r){let e=u.join(__dirname,"..","items",r);i.existsSync(e)&&i.unlinkSync(e)}return await a.deleteOne({_id:s}),t.status(200).send({status:!0,message:"Item deleted successfully"})}catch(e){return t.status(400).send({status:!1,message:e.message})}}}},671:(e,t,s)=>{const a=s(323),n=s(903),r=s(928),u=s(896),{getCurrentIPAddress:i,generateRandomAlphaNumericID:d}=s(93),{port:m}=s(669),o=s(915),{isValidObjectId:l}=s(37);e.exports={addMenu:async(e,t)=>{try{let{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"User Id is required"});let{title:d,description:l,isActive:g}=e.body;if(!await o.findOne({userId:s}))return t.status(400).send({status:!1,message:"Restaurant not found"});let c,{File_Extension:p,File_Path:f,File_data:y,File_name:I}=e.body.thumbnail;if(e.body.thumbnail){let e=Buffer.from(y,"base64"),t=i(),s="/menus/",a=n.v4()+p,d=`http://${t}:${m}${s}`,o=r.join(__dirname,"..","menus",a);u.writeFileSync(o,e),c={imgName:a,imgPath:d}}let _={title:d,description:l,thumbnail:c||"",isActive:g,userId:s},b=await a.create(_);return t.status(200).send({status:!0,message:"Menu added successfully",data:b})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getAllMenus:async(e,t)=>{try{let{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"userId is required"});let n=await a.find({userId:s});return t.status(200).send({status:!0,message:"Success",munus:n})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getMenuById:async(e,t)=>{try{let{menuId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"menuId is required"});if(!l(s))return t.status(400).send({status:!1,message:"Invalid menuId"});let n=await a.findById(s);return n?t.status(200).send({status:!0,message:"Success",data:n}):t.status(400).send({status:!1,message:"Menu not found"})}catch(e){return t.status(400).send({status:!1,message:e.message})}},updateMenu:async(e,t)=>{try{const{menuId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"menuId is required"});if(!l(s))return t.status(400).send({status:!1,message:"Invalid menuId"});let d=await a.findById(s);if(!d)return t.status(400).send({status:!1,message:"Menu not found"});let o=e.body;if("title"in o&&(d.title=o.title),"description"in o&&(d.description=o.description),"isActive"in o&&(d.isActive=o.isActive),"thumbnail"in o){let t=d.thumbnail.imgName,s=r.join(__dirname,"..","menus",t);u.existsSync(s)&&u.unlinkSync(s);let{File_Extension:a,File_Path:o,File_data:l,File_name:g}=e.body.thumbnail,c=Buffer.from(l,"base64"),p="/menus/",f=i(),y=n.v4()+a,I=`http://${f}:${m}${p}`,_=r.join(__dirname,"..","menus",y);u.writeFileSync(_,c);let b={imgName:y,imgPath:I};d.thumbnail=b}return await d.save(),t.status(200).send({status:!0,message:"Menu updated successfully",data:d})}catch(e){return t.status(400).send({status:!1,message:e.message})}},deleteMenu:async(e,t)=>{try{const{menuId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"menuId is required"});if(!l(s))return t.status(400).send({status:!1,message:"Invalid menuId"});let n=await a.findById(s);if(!n)return t.status(400).send({status:!1,message:"Menu not found"});let i=n.thumbnail.imgName,d=r.join(__dirname,"..","menus",i);return u.existsSync(d)&&u.unlinkSync(d),await a.deleteOne({_id:s}),t.status(200).send({status:!0,message:"Menu deleted successfully"})}catch(e){return t.status(400).send({status:!1,message:e.message})}}}},105:(e,t,s)=>{const{isValidObjectId:a}=s(37),n=s(470),r=s(915),u=s(903),i=(s(896),s(928));let{getCurrentIPAddress:d}=s(93);const{port:m}=s(669);e.exports={createOrder:async(e,t)=>{try{const{restaurant_id:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Restaurant Id is required"});if(!a(s))return t.status(400).send({status:!1,message:"Invalid Restaurant Id"});if(!await r.findOne({userId:s}))return t.status(400).send({status:!1,message:"Restaurant not found"});let{table_name:u,customer_name:i,customer_mobile:d,head_count:m,status:o,notes:l,item_list:g,total_items:c,tax:p,total:f,grand_total:y,question:I,feedback:_}=e.body,b=[];for(let e of g){let{item_name:t,qty:s,imgUrl:a,selling_price:n,isVeg:r,isTaxable:u}=e;b.push({item_name:t,qty:s,imgUrl:a,selling_price:n,isVeg:r,isTaxable:u})}let h={table_name:u,customer_name:i,customer_mobile:d,head_count:m,status:o,notes:l,item_list:g,total_items:c,tax:p,total:f,grand_total:y,question:I,feedback:_},S=await n.create(h);return t.status(200).send({status:!0,message:"Order created successfully",data:S})}catch(e){return t.status(500).send({status:!1,message:e.message})}},getAllOrders:async(e,t)=>{try{let e=await n.find();return t.status(200).send({status:!0,message:"Success",data:e})}catch(e){return t.status(500).send({status:!1,message:e.message})}},getOrderById:async(e,t)=>{try{let{orderId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Order Id is required"});if(!a(s))return t.status(400).send({status:!1,message:"Invalid Order Id"});let r=await n.findById(s);return r?t.status(200).send({status:!0,message:"Success",data:r}):t.status(400).send({status:!1,message:"Order not found"})}catch(e){return t.status(500).send({status:!1,message:e.message})}},updateOrderById:async(e,t)=>{try{const{orderId:s,restaurant_id:u,customer_name:i}=e.params;if(!s)return t.status(400).send({status:!1,message:"OrderId is required"});if(!a(s))return t.status(400).send({status:!1,message:"Invalid OrderId"});let d,m=await n.findById(s);if(!m)return t.status(400).send({status:!1,message:"Order not found"});if(u&&(d=await r.findOne({userId:u}),!d))return t.status(400).send({status:!1,message:"Restaurant Not Found"});let o=d||i,l=e.body;if("table_name"in l&&(m.table_name=l.table_name),"customer_name"in l&&(m.customer_name=l.customer_name),"customer_mobile"in l&&(m.customer_mobile=l.customer_mobile),"head_count"in l&&(m.head_count=l.head_count),"status"in l&&(m.status=l.status),"notes"in l&&(m.notes=l.notes),"item_list"in l&&m.item_list.length)for(let e of m.item_list)"item_name"in l.item_list&&(e.item_name=l.item_list.item_name),"qty"in l.item_list&&(e.qty=l.item_list.qty),"selling_price"in l.item_list&&(e.selling_price=l.item_list.selling_price),"isTaxable"in l.item_list&&(e.isTaxable=l.item_list.isTaxable),"isVeg"in l.item_list&&(e.isVeg=l.item_list.isVeg);return"total_items"in l&&(m.total_items=l.total_items),"tax"in l&&(m.tax=l.tax),"question"in l&&(m.question=l.question),"feedback"in l&&(m.feedback=l.feedback),await m.save(),t.status(200).send({status:!0,message:"Order updated successfully",data:m,canceledBy:o})}catch(e){return t.status(500).send({status:!1,message:e.message})}},deleteOrderById:async(e,t)=>{try{let{orderId:s}=e.params;return s?a(s)?await n.findById(s)?(await n.deleteOne({_id:s}),t.status(200).send({status:!0,message:"Order deleted successfully"})):t.status(400).send({status:!1,message:"Order not found"}):t.status(400).send({status:!1,message:"Invalid OrderId"}):t.status(400).send({status:!1,message:"OrderId is required"})}catch(e){return t.status(500).send({status:!1,message:e.message})}},cancelOrder:async(e,t)=>{try{let{orderId:s}=e.params;if(s)return t.status(400).send({status:!1,message:"OrderId is required"});if(!a(s))return t.status(400).send({status:!1,message:"Invalid orderId"});let u=await n.findById(s);if(!u)return t.status(400).send({status:!1,message:"Order Not found"});if("CANCELED"===u.status)return t.status(400).send({status:!1,message:"This order is already canceled"});let i,{status:d,restaurant_id:m,customer_mobile:o,customer_name:l}=e.body;m&&(i=await r.findOne({userId:m}));let g=i||l;return u.status=d,await u.save(),t.status(200).send({status:!0,message:"Order Canceled Successfully",data:u,canceledBy:g})}catch(e){return t.status(500).send({status:!1,message:e.message})}},updateOrderByRestaurant:async(e,t)=>{try{let{orderId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Order Id is required"});if(!a(s))return t.status(400).send({status:!1,message:"Invalid orderId"});let r=await n.findById(s);if(!r)return t.status(400).send({status:!1,message:"Order not found"});let{status:u}=e.body;return"CANCELED"===r.status?t.status(400).send({status:!1,message:"This order is already canceled"}):(r.status=u,await r.save(),t.status(200).send({status:!0,message:"Order updated successfully",order:r}))}catch(e){return t.status(500).send({status:!1,message:e.message})}},uploadItemImages:async(e,t)=>{try{let{itemId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Item Id is required"});let a=await itemModel.findById(s);if(!a)return t.status(400).send({status:!1,message:"Item not found"});let n=Array.isArray(e.files.itemImages)?e.files.itemImages:[e.files.itemImages];if(0===!n.length)return t.status(400).send({status:!1,message:"No item image uploaded"});let r=[];for(let e of n){let t="/items/",s=d(),a=u.v4()+"."+e.name.split(".").pop(),n=`http://${s}:${m}${t}`,o=i.join(__dirname,"..","items",a);e.mv(o,(e=>{if(e)throw e}));let l={imgName:a,imgUrl:n};r.push(l)}return t.status(200).send({status:!0,message:"Success",data:a})}catch(e){return t.status(500).send({status:!1,message:e.message})}}}},687:(e,t,s)=>{const a=s(915),n=s(950),r=s(903),u=s(928),i=s(896),{getCurrentIPAddress:d,generateRandomAlphaNumericID:m}=s(93),{port:o}=s(669),{isValidObjectId:l}=s(37),{adminSecretKey:g}=s(669);e.exports={authenticateAdmin:async(e,t)=>{try{let{userId:s,userName:n,email:r,profilePic:u}=e.body;const i=await a.findOne({userId:s});if(i)return t.status(200).send({status:!0,message:"Authentication successful",data:i});{let e={userId:s,userName:n,email:r,profilePic:u},i=await a.create(e);return t.status(200).send({status:!0,message:"Authentication successful",data:i})}}catch(e){return t.status(400).send({status:!1,message:e.message})}},updateRestaurantDatails:async(e,t)=>{try{const{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"userId is required"});let n=await a.findOne({userId:s});if(!n)return t.status(400).send({status:!1,message:"Restaurant not found"});let r=e.body;if("userName"in r&&(n.userName=r.userName),"restaurantName"in r&&(n.restaurantName=r.restaurantName),"mobile"in r&&(n.mobile=r.mobile),"description"in r&&(n.description=r.description),"restaurant_address"in r&&("address"in r.restaurant_address&&(n.restaurant_address.address=r.restaurant_address.address),"apartment"in r.restaurant_address&&(n.restaurant_address.apartment=r.restaurant_address.apartment),"city"in r.restaurant_address&&(n.restaurant_address.city=r.restaurant_address.city),"post_code"in r.restaurant_address&&(n.restaurant_address.post_code=r.restaurant_address.post_code),"state"in r.restaurant_address&&(n.restaurant_address.state=r.restaurant_address.state)),"slug"in r){let e=await a.find();for(let s of e)if(r.slug===s.slug)return t.status(200).send({status:!1,message:"This slug is duplicate"});n.slug=r.slug}return"sitting_capacity"in r&&(n.sitting_capacity=r.sitting_capacity),"isVeg"in r&&(n.isVeg=r.isVeg),"max_allow_seating"in e.body&&(n.max_allow_seating=r.max_allow_seating),"contact_number"in r&&(n.contact_number=r.contact_number),"contact_person"in r&&(n.contact_person=r.contact_person),"website"in r&&(n.website=r.website),"rating_review_url"in r&&(n.rating_review_url=r.rating_review_url),"GST_number"in r&&(n.GST_number=r.GST_number),"isActive"in r&&(n.isActive=r.isActive),await n.save(),t.status(200).send({status:!0,message:"Restaurant updated successfully",data:n})}catch(e){return t.status(400).send({status:!1,message:e.message})}},addUpdateLogo:async(e,t)=>{try{const{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"userId is required"});let n=await a.findOne({userId:s});if(!n)return t.status(400).send({status:!1,message:"Restaurant not found"});let{File_Extension:m,File_Path:l,File_data:g,File_name:c}=e.body,p=Buffer.from(g,"base64"),f=d(),y="/banners/",I=r.v4()+m,_=`http://${f}:${o}${y}`,b=u.join(__dirname,"..","banners",I),h=n.logo.logoName;if(h){let e=u.join(__dirname,"..","banners",h);i.existsSync(e)&&i.unlinkSync(e)}i.writeFileSync(b,p);let S={logoName:I,logoPath:_};return n.logo=S,await n.save(),t.status(200).send({status:!0,message:"logo updated successfully",logo:n.logo})}catch(e){return t.status(400).send({status:!1,message:e.message})}},deleteRestaurant:async(e,t)=>{try{let{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"userId is required"});let r=await a.findOne({userId:s});if(!r)return t.status(400).send({status:!1,message:"Restaurant not found"});const{reason:u,feedback:i}=e.body;let d={restaurant:r},m=JSON.stringify(d);await a.deleteOne({userId:s});let o={userId:s,deletedRestaurantData:m,reason:u,feedback:i,deletedAt:(new Date).toLocaleString()};return await n.create(o),t.status(200).send({status:!0,message:"Restaurant deleted successfully"})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getRestaurantById:async(e,t)=>{try{let{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"userId is required"});let n=await a.findOne({userId:s});return n?t.status(200).send({status:!0,message:"Success",data:n}):t.status(400).send({status:!1,message:"Restaurant not found"})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getAllRestaurants:async(e,t)=>{try{let{key:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"key is required"});if(s!==g)return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});let n=await a.find({});return t.status(200).send({status:!0,message:"Success",data:n})}catch(e){return t.status(400).send({status:!1,message:e.message})}}}},774:(e,t,s)=>{const a=s(178),n=s(915),{isValidObjectId:r}=s(37);e.exports={addTable:async(e,t)=>{try{let{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"User Id is required"});if(!await n.findOne({userId:s}))return t.status(400).send({status:!1,message:"Restaurant Not Found"});let r,u,{table_name:i,table_type:d,head_count:m,isIndoor:o}=e.body;if(!i||!d||!m||void 0===o)return t.status(400).send({status:!1,message:"All fields are required"});do{r=Math.floor(1e5+899999*Math.random()),u=await a.findOne({tableId:r})}while(u);let l={userId:s,tableId:r,table_name:i,table_type:d,head_count:m,isIndoor:o},g=await a.create(l);return t.status(200).send({status:!0,message:"Table added successfully",data:g})}catch(e){return t.status(500).send({status:!1,message:e.message})}},getAllTables:async(e,t)=>{try{let{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"User Id is required"});if(!await n.findOne({userId:s}))return t.status(400).send({status:!1,message:"Restaurant Not Found"});let r=await a.find({userId:s});return t.status(200).send({status:!0,message:"Success",data:r})}catch(e){return t.status(500).send({status:!1,message:e.message})}},getTableById:async(e,t)=>{try{let{tableId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Table Id is required"});if(!r(s))return t.status(400).send({status:!1,message:"Invalid TableId"});let n=await a.findById(s);return n?t.status(200).send({status:!0,message:"Success",data:n}):t.status(400).send({status:!1,message:"Table Not Found"})}catch(e){return t.status(500).send({status:!1,message:e.message})}},updateTableById:async(e,t)=>{try{let{tableId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Table Id is required"});if(!r(s))return t.status(400).send({status:!1,message:"Invalid TableId"});let n=await a.findById(s);if(!n)return t.status(400).send(400).send({status:!1,message:"Table Not Found"});let u=e.body;return"table_name"in u&&(n.table_name=u.table_name),"table_type"in u&&(n.table_type=u.table_type),"head_count"in u&&(n.head_count=u.head_count),"isIndoor"in u&&(n.isIndoor=u.isIndoor),await n.save(),t.status(200).send({status:!0,message:"Table updated successfully",data:n})}catch(e){return t.status(500).send({status:!1,message:e.message})}},deleteTableById:async(e,t)=>{try{let{tableId:s}=e.params;return s?r(s)?await a.findById(s)?(await a.deleteOne({_id:s}),t.status(200).send({status:!0,message:"Table deleted successfully"})):t.status(400).send(400).send({status:!1,message:"Table Not Found"}):t.status(400).send({status:!1,message:"Invalid TableId"}):t.status(400).send({status:!1,message:"Table Id is required"})}catch(e){return t.status(500).send({status:!1,message:e.message})}}}},797:e=>{class t extends Error{constructor(e,t,s,a){super(s),this.name=e,this.statusCode=t,this.details=a}}e.exports=t},526:(e,t,s)=>{const{isValidObjectId:a}=s(37),{tokenSecretKey:n}=s(669),r=s(107),u=s(829);e.exports={Authentication:async(e,t,s)=>{try{let a=e.headers.authorization;if(!a)return t.status(400).send({status:!1,message:"Token is required"});let r,i=a.split(" ")[1];if(!i)return t.status(400).send({status:!1,message:"Invalid token"});u.verify(i,n,((t,a)=>{if(t)throw t;r=a;let n=r.adminId;e.adminId=n,s()}))}catch(e){return t.status(500).send({status:!1,message:e.message})}},Authorization:async(e,t,s)=>{try{let n=e.adminId,{adminId:u}=e.params;if(!a(u))return t.status(400).send({status:!1,message:"Invalid userId"});let i=await r.findById(u);if(!i)return t.status(404).send({status:!1,message:"Admin not found"});let d=i._id;if(n.toString()!==d.toString())return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});s()}catch(e){return t.status(500).send({status:!1,message:e.message})}}}},107:(e,t,s)=>{const a=s(37),n=(a.Schema.Types.ObjectId,new a.Schema({userId:{type:String,unique:!0,default:""},name:{type:String,required:!0,trim:!0},email:{type:String,default:""},mobile:{type:String,default:""},password:{type:String,default:""}},{timestamps:!0}));e.exports=a.model("Admin",n)},950:(e,t,s)=>{const a=s(37),n=new a.Schema({userId:{type:String},deletedRestaurantData:{type:String},reason:{type:String},feedback:{type:String},deletedAt:{type:String}},{timestamps:!0});e.exports=a.model("DeletedRestaurant",n)},3:(e,t,s)=>{const a=s(37),n=(a.Schema.Types.ObjectId,new a.Schema({userId:{type:String,default:""},menuId:{type:String,default:""},item_name:{type:String,default:""},menuName:{type:String,default:""},description:{type:String,default:""},selling_price:{type:Number,default:0},isTaxable:{type:Boolean},preparing_time:{type:String,default:""},notes:{type:String,default:""},item_images:[{imgName:{type:String,default:""},imgPath:{type:String,default:""}}],visit_count:{type:Number,default:0},status:{type:Boolean},seo_keywords:[],video_link:{type:String,default:""},isVeg:{type:Boolean}},{timestamps:!0}));e.exports=a.model("Item",n)},323:(e,t,s)=>{const a=s(37),n=(a.Schema.Types.ObjectId,new a.Schema({userId:{type:String,default:""},title:{type:String,default:""},thumbnail:{imgName:{type:String,default:""},imgPath:{type:String,default:""}},description:{type:String,default:""},isActive:{type:Boolean,default:!0}},{timestamps:!0}));e.exports=a.model("Menu",n)},470:(e,t,s)=>{const a=s(37),n=(a.Schema.Types.ObjectId,new a.Schema({table_name:{type:String,default:""},restaurant_id:{type:String,default:""},customer_name:{type:String,default:""},customer_mobile:{type:String,default:""},head_count:{type:Number,default:1},status:{type:String,enum:["PENDING","PREPARING","CANCELED","APPROVED","COMPLETED","UNDEFINED"],default:"UNDEFINED"},notes:{type:String,default:""},item_list:[{item_name:{type:String,default:""},qty:{type:Number,default:1},selling_price:{type:Number,default:0},isTaxable:{type:Boolean},imgUrl:{type:String,default:""},isVeg:{type:Boolean}}],total_items:{type:Number},tax:{type:Number},total:{type:Number},grand_total:{type:Number},question:{type:String},feedback:{type:String}},{timestamps:!0}));e.exports=a.model("Order",n)},915:(e,t,s)=>{const a=s(37),n=(a.Schema.Types.ObjectId,new a.Schema({userId:{type:String,required:!0,unique:!0},userName:{type:String},email:{type:String},mobile:{type:String},profilePic:{type:String},restaurantName:{type:String,default:""},description:{type:String,default:""},restaurant_address:{address:{type:String,default:""},apartment:{type:String,default:""},city:{type:String,default:""},post_code:{type:String,default:""},state:{type:String,default:""}},logo:{logoName:{type:String,default:""},logoPath:{type:String,default:""}},slug:{type:String,default:""},sitting_capacity:{type:Number,default:0},isVeg:{type:Boolean,default:!0},max_allow_seating:{type:Number,default:0},banners:[{imageName:{type:String,default:""},imagePath:{type:String,default:""}}],contact_number:{type:String,default:""},contact_person:{type:String,default:""},website:{type:String,default:""},rating_review_url:{type:String,default:""},GST_number:{type:String,default:""},tax:{type:String},isActive:{type:Boolean,default:!0}},{timestamps:!0}));e.exports=a.model("Restaurant",n)},178:(e,t,s)=>{const a=s(37),n=(a.Schema.Types.ObjectId,new a.Schema({userId:{type:String},tableId:{type:String,required:!0,unique:!0},table_name:{type:String,required:!0,unique:!0},table_type:{type:String},head_count:{type:Number},isIndoor:{type:Boolean}},{timestamps:!0}));e.exports=a.model("Table",n)},508:(e,t,s)=>{const a=s(252).Router(),{createAdmin:n,adminLogin:r,getOneDayBookings:u,getOneWeekBookings:i,getOneMonthBookings:d,getOneYearBookings:m,getAllBookingsOfUser:o}=s(593),{Authentication:l,Authorization:g}=s(526);a.post("/api/v1/createSuperAdmin",n),a.post("/api/v1/loginSuperAdmin",r),a.get("/api/v1/getOneDayBookings/:adminId/:sessionToken/:date?",u),a.get("/api/v1/getOneWeekBookings/:adminId/:sessionToken/:startDate?/:endDate?",i),a.get("/api/v1/getOneMonthBookings/:adminId/:sessionToken/:month/:year",d),a.get("/api/v1/getOneYearBookings/:adminId/:sessionToken/:year",m),a.get("/api/v1/getUserAllBookings/:adminId/:sessionToken/:userId",o),e.exports=a},51:(e,t,s)=>{const a=s(252).Router(),{getDashboard:n,getAllBannerImages:r,updateBannerImages:u,deleteBannerImage:i}=s(506);a.get("/api/v1/getDashboard/:userId?",n),a.get("/api/v1/getBanners/:userId",r),a.put("/api/v1/addOrUpdateBanner/:userId",u),a.delete("/api/v1/deleteBanner/:imageId/:userId",i),e.exports=a},532:(e,t,s)=>{const a=s(252).Router(),{addItems:n,getAllItems:r,addUpdateItemImages:u,updateItemById:i,deleteItemById:d,deleteItemImages:m}=s(295);a.post("/api/v1/addItem/:userId",n),a.post("/api/v1/updateItemImages/:itemId",u),a.get("/api/v1/getAllItems/:userId",r),a.put("/api/v1/updateItem/:itemId",i),a.delete("/api/v1/deleteItem/:itemId",d),a.delete("/api/v1/deleteItemImage/:itemId/:imageId",m),e.exports=a},56:(e,t,s)=>{const a=s(252).Router(),{addMenu:n,getAllMenus:r,getMenuById:u,updateMenu:i,deleteMenu:d}=s(671);a.post("/api/v1/addMenu/:userId",n),a.get("/api/v1/getAllMenus/:userId",r),a.get("/api/v1/getMenu/:menuId",u),a.put("/api/v1/updateMenu/:menuId",i),a.delete("/api/v1/deleteMenu/:menuId",d),e.exports=a},139:(e,t,s)=>{const a=s(252).Router(),{createOrder:n,getAllOrders:r,getOrderById:u,updateOrderById:i}=s(105);a.post("/api/v1/createOrder/:restaurant_id",n),a.get("/api/v1/getAllOrders",r),a.get("/api/v1/getOder/:orderId",u),a.put("/api/v1/updateOrder/:orderId",i),e.exports=a},804:(e,t,s)=>{const a=s(252).Router(),{authenticateAdmin:n,updateRestaurantDatails:r,addUpdateLogo:u,getAllRestaurants:i,getRestaurantById:d,deleteRestaurant:m}=s(687);a.post("/api/v1/authenticateRestaurant",n),a.get("/api/v1/getRestaurant/:userId/:key",d),a.get("/api/v1/restaurant/:key",i),a.post("/api/v1/updateRestaurant/:userId",r),a.post("/api/v1/updateLogo/:userId",u),a.delete("/api/v1/deleteRestaurant/:userId",m),e.exports=a},727:(e,t,s)=>{const a=s(252).Router(),{addTable:n,getAllTables:r,getTableById:u,updateTableById:i,deleteTableById:d}=s(774);a.post("/api/v1/addTable/:userId",n),a.get("/api/v1/getAllTables/:userId",r),a.get("/api/v1/getTable/:tableId",u),a.put("/api/v1/updateTable/:tableId",i),a.delete("/api/v1/deleteTable/:tableId",d),e.exports=a},48:(e,t,s)=>{const a=s(797),{StatusCodes:n}=s(138);e.exports={errorHandler:function(e,t,s,r){return e instanceof a?s.status(e.statusCode).json({success:!1,message:e.message,err:e.details,data:{}}):s.status(n.INTERNAL_SERVER_ERROR).json({success:!1,message:"Something went wrong",err:e,data:{}})}}},93:(e,t,s)=>{const a=s(857);e.exports={getCurrentIPAddress:()=>{let e=a.networkInterfaces();return Object.values(e).flat().filter((e=>"IPv4"===e.family&&!e.internal)).map((e=>e.address))[0]},generateRandomAlphaNumericID:function(e){let t="";for(let s=0;s<e;s++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"[Math.floor(62*Math.random())];return t}}},486:e=>{"use strict";e.exports=require("bcrypt")},268:e=>{"use strict";e.exports=require("body-parser")},577:e=>{"use strict";e.exports=require("cors")},818:e=>{"use strict";e.exports=require("dotenv")},252:e=>{"use strict";e.exports=require("express")},376:e=>{"use strict";e.exports=require("express-fileupload")},138:e=>{"use strict";e.exports=require("http-status-codes")},829:e=>{"use strict";e.exports=require("jsonwebtoken")},37:e=>{"use strict";e.exports=require("mongoose")},903:e=>{"use strict";e.exports=require("uuid")},896:e=>{"use strict";e.exports=require("fs")},857:e=>{"use strict";e.exports=require("os")},928:e=>{"use strict";e.exports=require("path")}},t={};function s(a){var n=t[a];if(void 0!==n)return n.exports;var r=t[a]={exports:{}};return e[a](r,r.exports,s),r.exports}const a=s(252),n=s(268),r=s(376),u=s(577),{port:i}=s(669),{connectToDB:d}=s(865),{errorHandler:m}=s(48),o=a();o.use(a.json({limit:"50mb"})),o.use(a.urlencoded({extended:!0,limit:"50mb"})),o.use(n.json({limit:"50mb"})),o.use(r()),o.use(u());const l=s(508),g=s(804),c=s(51),p=s(139),f=s(56),y=s(532),I=s(727);o.use("/banners",a.static(__dirname+"/banners")),o.use("/items",a.static(__dirname+"/items")),o.use("/menus",a.static(__dirname+"/menus/")),o.use("/",l),o.use("/",g),o.use("/",c),o.use("/",p),o.use("/",f),o.use("/",y),o.use("/",I),o.get("/",((e,t)=>{t.send("<h1>QR App is Up and Running</h1>")})),o.use(m),o.listen(i,(async()=>{console.log("Server is running on port",i),await d(),console.log("Database connected")}))})();
//# sourceMappingURL=index.js.map